<!-- pages/login/login.wxml -->
<view class="login-container">
  <!-- 顶部logo/标题 -->
  <view class="login-header">
    <image class="logo" src="/images/logo.png" mode="widthFix"></image>
    <view class="title">欢迎登录</view>
    <view class="subtitle">体验更多专属功能</view>
  </view>

  <!-- 登录方式切换 -->
  <view class="login-tabs">
    <view class="tab-item {{loginType === 'wechat' ? 'active' : ''}}" bindtap="switchLoginType" data-type="wechat">
      微信快捷登录
    </view>
    <view class="tab-item {{loginType === 'phone' ? 'active' : ''}}" bindtap="switchLoginType" data-type="phone">
      手机号登录
    </view>
  </view>

  <!-- 微信登录面板 -->
  <view class="login-panel" wx:if="{{loginType === 'wechat'}}">
    <button class="wechat-login-btn" open-type="getUserProfile" bindgetuserprofile="onWechatLogin">
      <image class="wechat-icon" src="/images/wechat.png" mode="widthFix"></image>
      微信快捷登录
    </button>
    <view class="tips">登录即表示同意《用户协议》和《隐私政策》</view>
  </view>

  <!-- 手机号登录面板 -->
  <view class="login-panel" wx:if="{{loginType === 'phone'}}">
    <view class="form-item">
      <input 
        class="input" 
        type="number" 
        placeholder="请输入手机号" 
        value="{{phoneNumber}}"
        bindinput="onPhoneInput"
        maxlength="11"
      />
    </view>
    <view class="form-item code-item">
      <input 
        class="input code-input" 
        type="number" 
        placeholder="请输入验证码" 
        value="{{verifyCode}}"
        bindinput="onCodeInput"
      />
      <button 
        class="get-code-btn" 
        bindtap="getVerifyCode"
        disabled="{{countDown > 0 || !isPhoneValid}}"
      >
        {{countDown > 0 ? countDown + 's后重新获取' : '获取验证码'}}
      </button>
    </view>
    <button 
      class="phone-login-btn" 
      bindtap="onPhoneLogin"
      disabled="{{!isPhoneValid || !verifyCode}}"
    >
      登录
    </button>
  </view>

  <!-- 移除原有的wx-loading遮罩层，改用wx.showLoading API实现 -->
</view>